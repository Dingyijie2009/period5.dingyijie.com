<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joker price guessing game</title>
    <link href="css/main.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div class="stars"></div>

    <div class="main-content">
        <div class="card">
            <div class="terminal">
                <div class="terminal-header">
                    <span class="terminal-title">
                        <svg class="terminal-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
                             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 2v20M17 6c0-2-10-2-10 1s10 3 10 6-10 3-10 1"/>
                        </svg>
                        Guess Price
                    </span>
                </div>

                <div class="terminal-body">
                    <div class="command-line">
                        <span class="prompt">Your Guess:</span>
                        <div class="input-wrapper">
                            <input type="text" class="input-field" placeholder="Enter your guess"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="buttons">
            <button onclick="go_button()">GO</button>
            <button onclick="next_round()">NEXT</button>
            <button onclick="resetGame()">RESET</button>
        </div>
    </div>

    <!-- ITEMS + MESSAGE BOXES -->
    <div class="items-wrapper">

        <!-- TIP BOX -->
        <div class="info" id="tipBox">
            <div class="info__icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none"><path fill="#393a37" d="m13 13h-2v-6h2zm0 4h-2v-2h2zm-1-15c-1.3132 0-2.61358.25866-3.82683.7612-1.21326.50255-2.31565 1.23915-3.24424 2.16773-1.87536 1.87537-2.92893 4.41891-2.92893 7.07107 0 2.6522 1.05357 5.1957 2.92893 7.0711.92859.9286 2.03098 1.6651 3.24424 2.1677 1.21325.5025 2.51363.7612 3.82683.7612 2.6522 0 5.1957-1.0536 7.0711-2.9289 1.8753-1.8754 2.9289-4.4189 2.9289-7.0711 0-1.3132-.2587-2.61358-.7612-3.82683-.5026-1.21326-1.2391-2.31565-2.1677-3.24424-.9286-.92858-2.031-1.66518-3.2443-2.16773-1.2132-.50254-2.5136-.7612-3.8268-.7612z"></path></svg>
            </div>

            <div class="info__title" id="tipText">
                Please guess the price (0–180)
            </div>
        </div>

        <!-- ERROR BOX -->
        <div class="info" id="errorBox" style="display:none;">
            <div class="info__icon">
               <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" height="24" fill="none"><path fill="#393a37" d="m13 13h-2v-6h2zm0 4h-2v-2h2zm-1-15c-1.3132 0-2.61358.25866-3.82683.7612-1.21326.50255-2.31565 1.23915-3.24424 2.16773-1.87536 1.87537-2.92893 4.41891-2.92893 7.07107 0 2.6522 1.05357 5.1957 2.92893 7.0711.92859.9286 2.03098 1.6651 3.24424 2.1677 1.21325.5025 2.51363.7612 3.82683.7612 2.6522 0 5.1957-1.0536 7.0711-2.9289 1.8753-1.8754 2.9289-4.4189 2.9289-7.0711 0-1.3132-.2587-2.61358-.7612-3.82683-.5026-1.21326-1.2391-2.31565-2.1677-3.24424-.9286-.92858-2.031-1.66518-3.2443-2.16773-1.2132-.50254-2.5136-.7612-3.8268-.7612z"></path></svg>
            </div>

            <div class="info__title" id="errorText"></div>

            <div class="info__close" onclick="hideError()">
                <svg width="20" height="20" viewBox="0 0 20 20">
                    <path fill="#393a37"
                          d="m15.8333 5.34166-1.175-1.175
                             -4.6583 4.65834-4.65833-4.65834
                             -1.175 1.175 4.65833 4.65834
                             -4.65833 4.6583 1.175 1.175
                             4.65833-4.6583 4.6583 4.6583
                             1.175-1.175 -4.6583-4.6583z"/>
                </svg>
            </div>
        </div>

        <!-- ITEM IMAGE -->
        <div class="items">
            <img src="img/question.png" class="item">
        </div>

    </div>

    <!-- RULER + JOKER -->
    <div class="ruler-container">
        <img src="img/ruler.png" alt="ruler" class="ruler">
        <img src="img/joker_walk.png" alt="joker" class="joker">
    </div>

    <div class="creator">
        Creator: Yijie and Dan
    </div>

<script>
    // =======================
// VARIABLES
// =======================
let currentItem = null;
let roundFinished = false;
let currentRound = 0;       // track the round
const totalRounds = 3;      // max rounds


// DOM elements
const tipText = document.getElementById("tipText");
const errorText = document.getElementById("errorText");
const errorBox = document.getElementById("errorBox");
const joker = document.querySelector(".joker");
const inputField = document.querySelector(".input-field");

// export the items lists
const items = [
  { name: "Water", price: 1.00, image: "img/water.png" },
  { name: "notebook", price: 5.00, image: "img/notebook.png" },
  { name: "penset", price: 8.00, image: "img/penset.png" },
  { name: "backpack", price: 50.00, image: "img/backpack.png" },
  { name: "bicycle", price: 180.00, image: "img/bicycle.png" },
  { name: "blueteeth speaker", price: 40.00, image: "img/blueteeth speaker.png" },
  { name: "camera", price: 175.00, image: "img/camera.png" },
  { name: "coffee mug", price: 12.00, image: "img/coffee mug.png" },
  { name: "headphone", price: 25.00, image: "img/headphone.png" },
  { name: "jacket", price: 100.00, image: "img/jacket.png" },
  { name: "keyboard", price: 130.00, image: "img/keyboard.png" },
  { name: "laptop", price: 160.00, image: "img/laptop.png" },
  { name: "monitor", price: 170.00, image: "img/monitor.png" },
  { name: "blueteeth speaker", price: 40.00, image: "img/blueteeth speaker.png" },
  { name: "smartphone", price: 155.00, image: "img/smartphone.png" },
  { name: "smartwatch", price: 80.00, image: "img/smartwatch.png" },
  { name: "sneaker", price: 65.00, image: "img/sneakers.png" },
  { name: "tablet", price: 120.00, image: "img/tablet.png" },
  { name: "tshirt", price: 15.00, image: "img/tshirt.png" },
  { name: "wireless earbuds", price: 90.00, image: "img/wireless earbuds.png" }

  
  
];


// =======================
// START GAME
// =======================
window.onload = function () {
    startGame();
};

// =======================
// RANDOM ITEM SELECTION
// =======================
function selectOneItem() {
    let index = Math.floor(Math.random() * items.length);
    currentItem = items[index];
}

// =======================
// SHOW ITEM & TIP
// =======================
function showItem() {
    const img = document.querySelector(".item");
    img.src = currentItem.image;
    tipText.innerText = `Round ${currentRound + 1}: Guess the price of ${currentItem.name}`;
    inputField.value = "";
    resetJoker();
    roundFinished = false;
}

// =======================
// RESET JOKER
// =======================
function resetJoker() {
    joker.style.left = "-5%";
    joker.src = "img/joker_walk.png";
}

// =======================
// ERROR BOX
// =======================
function showError(message) {
    errorBox.style.display = "flex";
    errorText.innerText = message;
    errorBox.classList.remove("shake");
    void errorBox.offsetWidth;
    errorBox.classList.add("shake");
}

function hideError() {
    errorBox.style.display = "none";
}

// =======================
// STATUS DISPLAY
// =======================
function showStatus(guess, realPrice) {
    const difference = Math.abs(guess - realPrice);
    let message = `Your guess: $${guess.toFixed(2)} | Real price: $${realPrice.toFixed(2)} | Diff: $${difference.toFixed(2)}.`;

    if (difference <= 5) {
        message += " Great job!";
    } else if(difference > 18) {
        message += " The Joker fell off!";
        joker.style.left = "150%"
    }
    else {
        message += " Not bad or good";
        
    }

    tipText.innerText = `Round ${currentRound + 1}: ${message}`;
}

// =======================
// MOVE JOKER
// =======================
function moveJoker(guess) {
    const realPrice = currentItem.price;
    const difference = Math.abs(guess - realPrice);

    let percent; // Joker horizontal position in %

    if (difference > 18) {
        // Joker falls off the screen if too far off
        percent = 150; // way off screen
        joker.src = "img/joker_scared.png"; // change to fall image
        playFallSound();
    } else {
        // Map guess (0–max price) to 0–100% of screen
        const maxPrice = 180; // highest possible price in your items
        percent = (guess / maxPrice) * 100;

        // Change expression based on closeness
        if (difference === 0) {
            joker.src = "img/joker_happy.png";
        } else if (difference <= 5) {
            joker.src = "img/joker_walk.png";
        } else {
            joker.src = "img/joker_scared.png";
        }
    }

    // Move Joker
    joker.style.left = `${percent + 20}%`;
    joker.style.transform = 'translateX(-50%)'; // keep centered
}




// =======================
// FALL SOUND
// =======================
function playFallSound() {
    const audio = new Audio("sound/fall.mp3");
    audio.play();
}

// =======================
// GO BUTTON
// =======================
function go_button() {
    const inputValue = parseFloat(inputField.value);

    if (isNaN(inputValue)) {
        showError("Error: Please enter a valid number!");
        return;
    } else if(inputValue < 0 || inputValue > 180){
        showError("Error: Number is not in range (0-180)");
        return;
    } 

    hideError();
    roundFinished = true;

    showStatus(inputValue, currentItem.price);
    moveJoker(inputValue); // pass only the guess
}


// =======================
// NEXT BUTTON
// =======================
function next_round() {
    if (!roundFinished) {
        showError("You must make a valid guess before moving to next round!");
        return;
    }
    hideError();

    currentRound++;
    if (currentRound >= totalRounds) {
        tipText.innerText = "Game Over! Click Reset to play again.";
        return;
    }
    startRound();
}

// =======================
// RESET BUTTON
// =======================
function resetGame() {
    currentRound = 0;
    startGame();
    hideError();
}

// =======================
// START ROUND / GAME
// =======================
function startRound() {
    selectOneItem();
    showItem();
}

function startGame() {
    currentRound = 0;
    startRound();
}
// thank you for your checking!
</script>
</body>
</html>
